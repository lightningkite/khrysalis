"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Generated by Khrysalis TypeScript converter
// File: observables/binding/RatingBar.binding.actual.kt
// Package: com.lightningkite.khrysalis.observables.binding
const ObservableProperty_ext_shared_1 = require("../ObservableProperty.ext.shared");
const DisposeCondition_actual_1 = require("../../rx/DisposeCondition.actual");
//! Declares com.lightningkite.khrysalis.observables.binding.bind>android.widget.RatingBar
function ratingBarBindMutable(this_, stars, observable) {
    androidWidgetRatingBarBind(this_, stars, observable);
    const input = document.createElement("input");
    input.type = "range";
    input.min = "1";
    input.max = stars.toString();
    input.style.display = "none";
    this_.appendChild(input);
    let suppress = false;
    DisposeCondition_actual_1.ioReactivexDisposablesDisposableUntil(ObservableProperty_ext_shared_1.comLightningkiteKhrysalisObservablesObservablePropertySubscribeBy(observable, undefined, undefined, (value) => {
        if (!suppress) {
            suppress = true;
            input.valueAsNumber = (value);
            suppress = false;
        }
    }), DisposeCondition_actual_1.getAndroidViewViewRemoved(input));
    input.oninput = (e) => {
        if (!suppress) {
            suppress = true;
            observable.value = input.valueAsNumber;
            suppress = false;
        }
    };
    this_.tabIndex = 0;
    this_.addEventListener("keydown", (ev) => {
        switch (ev.code) {
            case "ArrowRight":
                ev.preventDefault();
                if (observable.value < stars) {
                    observable.value++;
                }
                break;
            case "ArrowLeft":
                ev.preventDefault();
                if (observable.value > 1) {
                    observable.value--;
                }
                break;
        }
    });
    for (let i = 0; i < stars; i++) {
        const e = this_.children.item(i);
        e.onclick = (ev) => {
            ev.stopPropagation();
            observable.value = i + 1;
        };
    }
}
exports.ratingBarBindMutable = ratingBarBindMutable;
//! Declares com.lightningkite.khrysalis.observables.binding.bind>android.widget.RatingBar
function androidWidgetRatingBarBind(this_, stars, observable) {
    for (let i = 0; i < stars; i++) {
        const e = document.createElement("div");
        e.classList.add("khrysalis-rating-bar-star");
        this_.appendChild(e);
    }
    DisposeCondition_actual_1.ioReactivexDisposablesDisposableUntil(ObservableProperty_ext_shared_1.comLightningkiteKhrysalisObservablesObservablePropertySubscribeBy(observable, undefined, undefined, (rating) => {
        for (let i = 0; i < stars; i++) {
            const e = this_.children.item(i);
            if (Math.round(i + 1) <= Math.round(rating)) {
                e.classList.add("khrysalis-rating-bar-star-on");
            }
            else {
                e.classList.remove("khrysalis-rating-bar-star-on");
            }
        }
    }), DisposeCondition_actual_1.getAndroidViewViewRemoved(this_));
}
exports.androidWidgetRatingBarBind = androidWidgetRatingBarBind;
//! Declares com.lightningkite.khrysalis.observables.binding.bindFloat>android.widget.RatingBar
function ratingBarBindFloatMutable(this_, stars, observable) {
    ratingBarBindMutable(this_, stars, observable);
}
exports.ratingBarBindFloatMutable = ratingBarBindFloatMutable;
//! Declares com.lightningkite.khrysalis.observables.binding.bindFloat>android.widget.RatingBar
function androidWidgetRatingBarBindFloat(this_, stars, observable) {
    androidWidgetRatingBarBind(this_, stars, observable);
}
exports.androidWidgetRatingBarBindFloat = androidWidgetRatingBarBindFloat;
//# sourceMappingURL=RatingBar.binding.actual.js.map