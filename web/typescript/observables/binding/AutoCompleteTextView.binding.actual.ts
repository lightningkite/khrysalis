// Generated by Khrysalis TypeScript converter - this file will be overwritten.
// File: observables/binding/AutoCompleteTextView.binding.actual.kt
// Package: com.lightningkite.khrysalis.observables.binding
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getView.convertView TS convertView
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getView.view TS view
// FQImport: android.widget.TextView.letterSpacing TS letterSpacing
// FQImport: android.os.Build.VERSION_CODES.LOLLIPOP TS LOLLIPOP
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getView.position TS position
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getFilter.<no name provided>.performFiltering.<anonymous>.<anonymous>.<anonymous>.q TS q
// FQImport: com.lightningkite.khrysalis.observables.subscribeBy>com.lightningkite.khrysalis.observables.ObservableProperty<kotlin.Any> TS comLightningkiteKhrysalisObservablesObservablePropertySubscribeBy
// FQImport: android.widget.AutoCompleteTextView.letterSpacing TS letterSpacing
// FQImport: android.os.Build TS Build
// FQImport: kotlin.text.contains>kotlin.CharSequence TS kotlinCharSequenceContains
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getFilter.<no name provided>.performFiltering.<anonymous>.query TS query
// FQImport: android.view.ViewGroup TS ViewGroup
// FQImport: android.widget.AutoCompleteTextView.maxLines TS maxLines
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getFilter.<no name provided>.convertResultToString.resultValue TS resultValue
// FQImport: com.lightningkite.khrysalis.rx.until>io.reactivex.disposables.Disposable TS ioReactivexDisposablesDisposableUntil
// FQImport: kotlin.CharSequence.toString TS toString
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.toString TS toString
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getView.<anonymous>.size TS size
// FQImport: android.widget.TextView.resources TS resources
// FQImport: android.widget.Filter.FilterResults.values TS values
// FQImport: kotlin.collections.getOrNull>kotlin.collections.List<kotlin.Any> TS kotlinCollectionsListGetOrNull
// FQImport: android.widget.AutoCompleteTextView.setAdapter TS setAdapter
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getFilter.<no name provided>.performFiltering.<anonymous>.newFilteredOptions TS newFilteredOptions
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getFilter.<no name provided>.publishResults.p1 TS p1
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getItem.position TS position
// FQImport: com.lightningkite.khrysalis.rx.removed>android.view.View TS getAndroidViewViewRemoved
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getFilter.<no name provided>.performFiltering.<anonymous>.<anonymous>.it TS it
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.<init>.<anonymous>.text TS text
// FQImport: android.widget.Filterable TS Filterable
// FQImport: android.widget.TextView.context TS context
// FQImport: android.os.Build.VERSION.SDK_INT TS SDK_INT
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.notifyDataSetChanged TS notifyDataSetChanged
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getFilter.<no name provided>.performFiltering.p0 TS p0
// FQImport: android.widget.TextView.textSize TS textSize
// FQImport: android.os.Build.VERSION_CODES TS VERSION_CODES
// FQImport: android.widget.Filter.FilterResults TS FilterResults
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.filter TS filter
// FQImport: android.widget.AutoCompleteTextView.textColors TS textColors
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.options TS options
// FQImport: android.widget.BaseAdapter TS BaseAdapter
// FQImport: kotlin.CharSequence TS CharSequence
// FQImport: android.widget.Filter.FilterResults.count TS count
// FQImport: android.os.Build.VERSION_CODES.JELLY_BEAN TS JELLY_BEAN
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.T TS T
// FQImport: android.widget.TextView.setTextColor TS setTextColor
// FQImport: kotlin.collections.List.toString TS toString
// FQImport: android.widget.Filter TS Filter
// FQImport: android.widget.TextView.maxLines TS maxLines
// FQImport: android.widget.Filter.filter TS filter
// FQImport: android.os.Build.VERSION TS VERSION
// FQImport: com.lightningkite.khrysalis.observables.ObservableProperty TS ObservableProperty
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<no name provided>.getItemId.position TS position
// FQImport: android.widget.AutoCompleteTextView.textSize TS textSize
// FQImport: android.content.Context.resources TS resources
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.onItemSelected TS onItemSelected
// FQImport: android.util.DisplayMetrics.scaledDensity TS scaledDensity
// FQImport: android.content.res.Resources.displayMetrics TS displayMetrics
// FQImport: android.util.DisplayMetrics.density TS density
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.filtered TS filtered
// FQImport: com.lightningkite.khrysalis.observables.binding.bind.<anonymous>.index TS index
// FQImport: android.widget.AutoCompleteTextView.setOnItemClickListener TS setOnItemClickListener
// FQImport: com.lightningkite.khrysalis.observables.ObservableProperty.value TS value
import { comLightningkiteKhrysalisObservablesObservablePropertySubscribeBy } from './../ObservableProperty.ext.shared'
import { also, takeUnless, tryCastClass, tryCastInterface, tryCastPrimitive } from 'Kotlin'
import { getAndroidViewViewRemoved, ioReactivexDisposablesDisposableUntil } from './../../rx/DisposeCondition.actual'
import { ObservableProperty } from './../ObservableProperty.shared'

//! Declares com.lightningkite.khrysalis.observables.binding.bind>android.widget.AutoCompleteTextView
export function androidWidgetAutoCompleteTextViewBind<T>(this_: HTMLInputElement, options: ObservableProperty<Array<T>>, toString: (a: T) => string, onItemSelected: (a: T) => void): void{
    const filtered = Array.from(options.value);
    
    this_.setAdapter(new class Anon extends BaseAdapter implements Filterable {
            public static implementsInterfaceAndroidWidgetFilterable = true;
            public constructor() {
                super();
                ioReactivexDisposablesDisposableUntil(comLightningkiteKhrysalisObservablesObservablePropertySubscribeBy(options, undefined, undefined, (text) => {
                            this.filter.filter(text.toString())
                }), getAndroidViewViewRemoved(this_));
            }
            
            
            getFilter(): Filter{ return new class Anon extends Filter {
                    public constructor() {
                        super();
                    }
                    
                    performFiltering(p0: (CharSequence | null)): FilterResults{ return also(FilterResults.constructor(), (this_1) => {
                                const query = ((_it)=>{
                                        if(_it === null) return null;
                                        return takeUnless(_it, (it) => it.length === 0)
                                })(((_it)=>{
                                            if(_it === null) return null;
                                            return _it.split(" ")
                                })(p0?.toString()));
                                
                                if (!(query.equals(null))) {
                                    const newFilteredOptions = options.value.filter((it) => query.every((q) => kotlinCharSequenceContains((toString)(it), q, true)));
                                    
                                    this_1.values = newFilteredOptions;
                                    this_1.count = newFilteredOptions.length;
                                } else {
                                    this_1.values = options.value;
                                    this_1.count = options.value.length;
                                }
                    }); }
                    
                    convertResultToString(resultValue: (any | null)): CharSequence{
                        return ((_it)=>{
                                if(_it === null) return null;
                                return (toString)(_it)
                        })((tryCastPrimitive<T>(resultValue, "any"))) ?? "";
                    }
                    
                    publishResults(p0: (CharSequence | null), p1: (FilterResults | null)): void{
                        filtered.length = 0;
                        filtered.push(...tryCastInterface<Array<T>>(p1?.values, "KotlinCollectionsList") ?? []);
                        this.notifyDataSetChanged();
                    }
            }(); }
            
            
            
            getView(position: number, convertView: (HTMLElement | null), parent: (ViewGroup | null)): HTMLElement{
                const view = (tryCastClass<HTMLElement>(convertView, HTMLElement)) ?? also(document.createElement('p'), (this_1) => {
                        this_1.setTextColor(this_.textColors);
                        this_1.textSize = this_.textSize / this_1.resources.displayMetrics.scaledDensity;
                        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
                            this_1.maxLines = this_.maxLines;
                        }
                        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {
                            this_1.letterSpacing = this_.letterSpacing;
                        }
                        const size = Math.floor((this_1.context.resources.displayMetrics.density * 8));
                        
                        this_1.style.padding = `${size}px ${size}px ${size}px ${size}px `;
                });
                
                view.innerText = ((_it)=>{
                        if(_it === null) return null;
                        return (toString)(_it)
                })(kotlinCollectionsListGetOrNull(filtered, position));
                return view;
            }
            
            getItem(position: number): (any | null){ return kotlinCollectionsListGetOrNull(filtered, position); }
            getItemId(position: number): number{ return position; }
            getCount(): number{ return filtered.length; }
    }());
    this_.setOnItemClickListener((adapterView, view, index, id) => {
            const temp323 = kotlinCollectionsListGetOrNull(filtered, index);
            if(temp323 !== null) (onItemSelected)(temp323)
    });
}

