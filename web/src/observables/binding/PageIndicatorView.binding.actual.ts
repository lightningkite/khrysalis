// Generated by Khrysalis TypeScript converter
// File: observables/binding/PageIndicatorView.binding.actual.kt
// Package: com.lightningkite.khrysalis.observables.binding
import { xObservablePropertySubscribeBy } from '../ObservableProperty.ext.shared'
import { xViewRemovedGet, xDisposableUntil } from '../../rx/DisposeCondition.actual'
import { ObservableProperty } from '../ObservableProperty.shared'
import { xObservablePropertyCombine } from '../CombineObservableProperty.shared'
import { MutableObservableProperty } from '../MutableObservableProperty.shared'

//! Declares com.lightningkite.khrysalis.observables.binding.bind>com.rd.PageIndicatorView
export function xPageIndicatorViewBind(this_: HTMLDivElement, count: number = 0, selected: MutableObservableProperty<number>): void {
    for(let i = 0; i < count; i++){
        const e = document.createElement("div");
        e.classList.add("khrysalis-page-indicator-dot");
        this_.appendChild(e);
    }
    let previouslyActive = this_.firstElementChild;
    xDisposableUntil(xObservablePropertySubscribeBy(selected, undefined, undefined, (page)=>{
        if(previouslyActive){
            previouslyActive.classList.remove("khrysalis-page-indicator-dot-active");
        }
        const e = this_.children.item(page);
        if(e){
            e.classList.add("khrysalis-page-indicator-dot-active");
        }
        previouslyActive = e;
    }), xViewRemovedGet(this_));
}

//! Declares com.lightningkite.khrysalis.observables.binding.bind>com.rd.PageIndicatorView
export function xPageIndicatorViewBindDynamic(this_: HTMLDivElement, count: ObservableProperty<number>, selected: MutableObservableProperty<number>): void {
    let previouslyActive = this_.firstElementChild;
    xDisposableUntil(xObservablePropertySubscribeBy(count, undefined, undefined, (count)=>{
        this_.innerHTML = "";
        for(let i = 0; i < count; i++){
            const e = document.createElement("div");
            e.classList.add("khrysalis-page-indicator-dot");
            if(i === selected.value){
                e.classList.add("khrysalis-page-indicator-dot-active");
                previouslyActive = e;
            }
            this_.appendChild(e);
        }
    }), xViewRemovedGet(this_));
    xDisposableUntil(xObservablePropertySubscribeBy(selected, undefined, undefined, (page)=>{
        if(previouslyActive){
            previouslyActive.classList.remove("khrysalis-page-indicator-dot-active");
        }
        const e = this_.children.item(page);
        if(e){
            e.classList.add("khrysalis-page-indicator-dot-active");
        }
        previouslyActive = e;
    }), xViewRemovedGet(this_));
}

